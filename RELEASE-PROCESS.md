# Release Process

The release process is mix of automation and scripts.
This document walks through process of creating a new release.

## Prepare the Release Notes

We manage release notes under `debian/changelog`.
The GitHub workflow release action uses these when creating the release in GitHub.
The changelog can be generated by running:

```
 ./debian/release-prep-changelog.sh <next version>

 \# if we are going to release v42.0.0, we'd run:
 ./debian/release-prep-changelog.sh 42.0.0
```

It is a good idea to go through the changes and clean them up where needed.
Once the release notes look good, commit them and push to GitHub.

## Create the Release in GitHub

We simply create a tag and push that to GitHub:

```
 git tag v42.0.0
 git push --tags
```

This will launch a workflow that builds all the binaries and attaches
them to a new GitHub release.

## Publish Debian Packages to Archive

Assume we are releasing v42.0.0

```
 mkdir /tmp/archive
 ./debian/release-prep-archive.sh /tmp/archive 42.0.0
 ./debian/release-publish-archive.sh <path to signing keys>/ /tmp/archive
```

As a sanity check run `find /tmp/archive` then push to the archive with:

```
 gsutil rsync -r /tmp/archive/ gs://fioup.foundries.io/
```
